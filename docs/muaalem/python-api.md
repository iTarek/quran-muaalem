# Python API

The core inference class is `Muaalem` in `src/quran_muaalem/inference.py`.

## Class Signature

```python
class Muaalem:
    def __init__(
        self,
        model_name_or_path: str = "obadx/muaalem-model-v3_2",
        device: str = "cpu",
        dtype=torch.bfloat16,
    ):
        ...

    @torch.no_grad()
    def __call__(
        self,
        waves: list[list[float] | torch.FloatTensor | NDArray],
        ref_quran_phonetic_script_list: list[QuranPhoneticScriptOutput],
        sampling_rate: int,
    ) -> list[MuaalemOutput]:
        ...
```

Notes from the implementation:

- `sampling_rate` must be `16000` or a `ValueError` is raised.
- `model_name_or_path` defaults to `obadx/muaalem-model-v3_2`.
- `dtype` defaults to `torch.bfloat16`.

## Required Inputs

- **Audio**: raw waveform arrays loaded at 16 kHz.
- **Reference**: `QuranPhoneticScriptOutput` generated by `quran_transcript.quran_phonetizer`.

## Output Types

See `src/quran_muaalem/muaalem_typing.py`:

- `Unit`: a decoded sequence of phonemes with probabilities and ids.
- `Sifa`: a per-phoneme group of phonetic attributes.
- `MuaalemOutput`: the container with `phonemes` and `sifat`.

For a concrete example, check the `README.md` code sample.
